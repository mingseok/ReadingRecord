## 스트림과 컬렉션

자바의 기존 컬렉션과 새로운 스트림 모두 연속된 요소 형식의 값을 

저장하는 자료구조의 인터페이스를 제공한다. 

<br/>

여기서 연속된 이라는 표현은 순서와 상관없이 아무 값에나 접속하는 것이 아니라 

순차적으로 값에 접근한다는 것을 의미한다. 

<br/>

데이터를 언제 계산하느냐가 컬렉션과 스트림의 가장 큰 차이다.

컬렉션은 현재 자료구조가 포함하는 모든 값을 메모리에 저장하는 자료구조다.

<br/>

즉, 컬렉션의 모든 요소는 컬렉션에 추가하기 전에 계산되어야 한다.

(컬렉션에 요소를 추가하거나 컬렉션의 요소를 삭제할 수 있다.)

<br/>

반면 스트림은 이론적으로 요청할 때만 요소를 계산하는 고정된 자료구조다.

(스트림에 요소를 추가하거나 스트림에서 요소를 제거할 수 없다)


<br/>

### 이러한 스트림의 특성은 프로그래밍에 큰 도움을 준다.

```
사용자가 요청하는 값만 스트림에서 추출한다는 것이 핵심이다.
```

즉, 사용자가 데이터를 요청할 때만 값을 계산한다.

반면 컬렉션은 적극적으로 생성된다.

(생산자 중심 : 팔기도 전에 창고를 가득 채움)

<br/><br/>

## 인터넷 스트리밍 예제

```
브라우저 인터넷 검색이 있다.
```

구글이나 전자상거래에서 검색어를 입력했다고 가정하자.

그림을 포함한 모든 검색 결과를 내려받을 때까지 기다리지 않아도 가장 비슷한 10개 또는 20개의 

결과 요소를 포함하는 스트림을 얻을 수 있다.

<br/>

### 스트림과 컬렉션

- 컬렉션은 DVD에 저장된 영화에 비유할 수 있다.

- 스트림은 인터넷으로 스트리밍하는 영화에 비유할 수 있다.

<br/><br/>

## 딱 한번만 탐색할 수 있다.

반복자와 마찬가지로 스트림도 한 번만 탐색할 수 있다.

- 다시 탐색하려면 초기 데이터 소스에서 새로운 스트림을 만들어야 한다.

<br/><br/>

## 외부 반복과 내부 반복

컬렉션 인터페이스를 사용하려면 사용자가 직접 요소를 반복해야 한다.

(예를 들면 `for-each`등을 사용해서) 이를 외부 반복이라고 한다.

<br/>

반면, 스트림 라이브러리는 (반복을 알아서 처리하고 결과 스트림값을 어딘가에 저장해주는)

내부 반복을 사용한다.

```java
List<String> names = menu.stream()
			 .map(Dish::getName) // map 메서드를 getName메서드로 
				             // 파라미터화해서 요리명을 추출한다.
			 .collect(toList()); // 파이프라인을 실행한다. 반복자는 필요없다.
```

<br/><br/>

## 내부 반복과 외부 반복의 다른점

소피아에게 인형을 정리하라고 말하는 상황이다.

```
마리오 : "소피아, 장난감 좀 정리하렴. 방바닥에 장난감이 있지?"

소피아 : "네, 공이 있어요."

마리오 : "좋아, 그럼 공을 상자에 담자. 또 어떤 장난감이 있지?"

소피아 : "인형이 있어요."

마리오 : "그럼 인형을 상자에 담자. 또 어떤 장난감이 있지?"

소피아 : "책이 있어요."

마리오 : "그럼 책을 상자에 담자. 또 어떤 장난감이 있지?"

소피아 : "아무것도 없어요."

마리오 : "참 잘했어."
```

우리는 이처럼, 자바 컬렉션을 사용한다.

컬렉션은 외부적으로 반복, 즉 명시적으로 컬렉션 항목을 하나씩 가져와서 처리한다.

<br/><br/>


```
"소피아, 바닥에 있는 모든 장난감을 상자에 담자" 라고 말할 수 있다면 얼마나 좋을까?
```

내부 반복이 더 좋은 다른 두가지 이유가 더 있다.

<br/>

첫번째로. 소피아가 한 손에는 인형을 다른 한 손에는 공을 동시에 들 수 있다는 점이고,

둘째로, 먼저 모든 장난감을 상자 가까이 이동시킨 다음에 장난감을 상자에 넣을 수 있다는 점이다.

<br/>

이렇듯 내부 반복을 이용하면 작업을 투명하게 병렬로 처리하거나 더 최적화된 다양한 순서로 처리할 수 있다.

```
스트림은 내부 반복을 사용하므로 반복 과정을 우리가 신경 쓰지 않아도 된다.
```

<br/><br/>

>**Reference** 
> <br/> [모던 자바 인 액션](http://www.yes24.com/Product/Goods/77125987)
